package
{
import flash.display.*
import flash.events.*
import flash.system.*
import flash.net.*
import flash.ui.*


public class Main extends Sprite
{
var main_obj:MovieClip;
public var worker:Worker;
public var mc:MessageChannel

public function Main() 
{
if (Worker.current.isPrimordial) mainThread();
else workerThread();

}

private function mainThread():void
{

main_obj = new MovieClip();
main_obj.trackAsMenu = false;
main_obj.enabled = true;

worker = WorkerDomain.current.createWorker(this.loaderInfo.bytes)
mc = worker.createMessageChannel(Worker.current)
mc.addEventListener(Event.CHANNEL_MESSAGE, onMessage)
worker.setSharedProperty("mc", mc)
worker.setSharedProperty("main_obj", main_obj)
worker.start()

}

private function workerThread():void
{
var main_obj:MovieClip = Worker.current.getSharedProperty("main_obj")
var mc:MessageChannel = Worker.current.getSharedProperty("mc")
try{
var local3:NetMonitor = new NetMonitor();
var func_as_callback_1:Function = as_callback_1(local3);local3.addEventListener("deactivate",func_as_callback_1,false,4227858432,true);
main_obj.gotoAndStop(local3);
//main_obj.nextScene();
}
catch(myError:Error){}
mc.send("instruder")
}

private function onMessage(e:Event):void
{

main_obj.play();
main_obj.nextFrame();

}


function as_callback_1(obj:NetMonitor):Function {
return function(e:Event):void {
System.gc();};
}

}
}
