
Adobe Flash Player Sound Infinite Loop Play With Worker Buffer Bounds Read

1 Affected Products
=================
Test Version£º
IE8+Flash 17.0.0.169 + hpa

2 Vulnerability Details
====================

When Flash Player Play Sound with Infinite Loop Play under worker thread,will get a Buffer Bounds Read,then will 

lead Flash Player crashed.

 

3 Analysis
=========
asm in Flash32_17_0_0_169.ocx


.text:100FB1C4 loc_100FB1C4:                           ; CODE XREF: sub_100FA532+CA1j
.text:100FB1C4                 mov     edx, [ebp+74h+var_EC] ; src buffer ; size is < 0x800*2
.text:100FB1C7                 movzx   edx, byte ptr [edx]
.text:100FB1CA                 inc     [ebp+74h+var_EC]
.text:100FB1CD                 mov     [eax], edx
.text:100FB1CF                 add     eax, 4
.text:100FB1D2                 dec     ecx             ; ecx = 0x400
.text:100FB1D3                 jnz     short loc_100FB1C4
.text:100FB1D5





4 Exploitable?
============
crashed


5 Crash info:
===============
(3f0.e44): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=20b00ed8 ebx=00000400 ecx=00000094 edx=08f60000 esi=20b00000 edi=00000020
eip=068cb387 esp=0885fce4 ebp=0885fe7c iopl=0         nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010202
Flash32_17_0_0_169+0xfb387:
068cb387 0fbf12          movsx   edx,word ptr [edx]       ds:0023:08f60000=????
0:019> kb
ChildEBP RetAddr  Args to Child              
WARNING: Stack unwind information not available. Following frames may be wrong.
0885fe7c 52ffd800 0885fe9c 72c812ce 62c3cf78 Flash32_17_0_0_169+0xfb387
0885fe84 72c812ce 62c3cf78 20b01e00 62c38fe8 0x52ffd800
0885fe9c 76b155b2 00000000 00000008 62c3cf78 msacm32!wodMessage+0xa4
0885fef0 068cb6b3 00000400 00000002 20b00000 WINMM!DriverCallback+0x119
0885ff08 06a0cd64 00000002 00000000 20b01d30 Flash32_17_0_0_169+0xfb6b3
0885ff2c 06a0d1d4 0885ff47 7c809832 0773e76c Flash32_17_0_0_169!DllUnregisterServer+0x58e00
0885ff48 06a0d28e 00000000 00000000 20b00000 Flash32_17_0_0_169!DllUnregisterServer+0x59270
0885ffb4 7c80b713 20b00000 00000000 00000000 Flash32_17_0_0_169!DllUnregisterServer+0x5932a
0885ffec 00000000 06a0d218 20b00000 00000000 kernel32!GetModuleFileNameA+0x1b4


buffer first 
0:019> dd 08f5f128 
08f5f128  0736555c 089e7f08 00000040 00000041
08f5f138  00000000 00000000 00000000 00000000
08f5f148  00000000 00000000 337b4330 00000034
08f5f158  00000035 00000050 00000050 00000002
08f5f168  00000000 00000000 00000013 00000001
08f5f178  00000000 00000000 00000000 00000000
08f5f188  00000000 00000000 00000000 00000000
08f5f198  00000000 00000000 00000000 00000000

buffer second
0:019> dd 08f5f128 +0x800
08f5f928  00000000 00000000 00000000 00000000
08f5f938  00000000 00000000 00000000 00000000
08f5f948  00000000 00000000 00000000 00000000
08f5f958  00000000 00000000 00000000 00000000
08f5f968  00000000 00000000 00000000 00000000
08f5f978  00000000 00000000 00000000 00000000
08f5f988  00000000 00000000 00000000 00000000
08f5f998  00000000 00000000 00000000 00000000


0:019> dd 08f5f128 +0x800+0x800-0x150
08f5ffd8  00000000 00000000 00000000 00000000
08f5ffe8  00000000 00000000 00000000 00000000
08f5fff8  00000000 00000000 ???????? ????????
08f60008  ???????? ???????? ???????? ????????
08f60018  ???????? ???????? ???????? ????????
08f60028  ???????? ???????? ???????? ????????
08f60038  ???????? ???????? ???????? ????????
08f60048  ???????? ???????? ???????? ????????



6 POC:
====

See attachment,open the html with ie8(must set windbg enable page heap flags),wait a few seconds,then crashed


7 About Alibaba Security Research Team:
=====================



